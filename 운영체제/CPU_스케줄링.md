> 선경

### CPU 스케줄링

운영체제는 **스케줄링 정책**을 통해 여러 프로세스 중 CPU를 넘겨줄 프로세스를 선택한다. 스케줄링 정책은 결정을 내리기 위해 과거 정보(e.g. 직전 1분 동안 어떤 프로그램이 자주 실행되었는지), 워크로드에 관한 정보(e.g. 어떤 유형의 프로그램들이 실행되었는지), 성능 측정 결과(e.g. 단위시간당 처리량, 응답시간 등) 등을 이용한다. 

프로세스가 운영체제의 스케줄링 정책에 따라 스케줄이 되면 준비 상태에서 실행 상태로 변경된다. 

<br>

#### 스케줄링 평가 항목
어떤 스케줄링 정책이 좋은 정책일까? 다음과 같은 평가 항목이 기준이 될 수 있다. 
- **반환 시간**: 작업이 완료된 시각 - 작업이 도착한 시각
- **응답 시간**: 작업이 처음으로 스케줄 된 시각 - 작업이 도착한 시각
- **공정성**: 모든 작업에 실행 기회를 비슷하게 분배하는지 여부

성능과 공정성은 스케줄링에서 상충된다. 

<br>

#### 스케줄링 정책의 종류

> **비선점형 스케줄러**: 실행중인 작업이 종료될 때까지 계속 실행
##### FCFS(First Come First Served)
먼저 도착한 작업을 먼저 실행한다. 단순하고 구현하기 쉬우나, CPU를 많이 필요로 하지 않는 프로세스들이 CPU를 오랫동안 사용하는 프로세스가 끝나기를 기다려야 하는 **convoy effect**가 발생한다. 

##### SJF(Shortest Job First)
가장 짧은 실행 시간을 가진 작업을 먼저 실행한다. 모든 작업이 동시에 도착한다면 최적이나 CPU를 오랫동안 사용하는 프로세스가 먼저 도착한다면 마찬가지로 **convoy effect**가 발생한다. 

<br>

> **선점형 스케줄러**: 실행중인 작업을 중지하고 다른 작업을 실행할 수 있음 
##### STCF(Shortest Time-to-Completion First)
현재 실행중인 작업의 잔여 실행 시간과 새로운 작업의 잔여 실행 시간을 비교하여, 잔여 실행 시간이 가장 작은 작업을 스케줄한다.


##### Round-Robin(RR)
하나의 작업을 일정 시간(i.e. 타임 슬라이스, 스케줄링 퀀텀) 동안 실행한 후 실행 큐의 다음 작업으로 전환한다. 이때, 타임 슬라이스의 길이는 타이머 인터럽트 주기의 배수여야 한다. 응답 시간을 기준으로 하면 성능이 좋으나 타임 슬라이스를 너무 짧게 설정하면 문맥 교환 비용이 커지는 단점이 있다. 

##### MLFQ(Multi-level Feedback Queue)
각각 다른 우선순위가 배정된 여러 개의 큐로 구성되며 준비 상태의 프로세스는 이 중 하나의 큐에 존재한다. 각 프로세스의 우선 순위는 해당 프로세스의 실행을 관찰한 후 그에 따라 조정되는데 아래와 같은 방식으로 운용된다. 

1. 작업이 시스템에 들어가면 최상위 큐에 배치된다. 
2. 작업이 지정된 단계에서 배정받은 시간을 소진하면 작업의 우선순위는 감소한다.(한 단계 아래 큐로 이동)
3. 우선순위(A) > 우선순위(B) 일 경우, A가 실행되고 B는 실행되지 않는다. 
4. 우선순위(A) = 우선순위(B) 일 경우, A와 B는 RR 방식으로 실행된다. 
5. 일정 주기 S가 지난 후, 시스템의 모든 작업은 최상위 큐로 이동한다. 


반환 시간과 응답 시간을 모두 최적화하지만 적절한 타임 슬라이스 크기 설정, 우선순위 상향 조정 주기 등을 결정하는 데 어려움이 있다. 