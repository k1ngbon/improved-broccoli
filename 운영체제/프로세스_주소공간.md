> 선경

### 주소공간

운영체제는 **메모리 가상화**를 통해 각 프로세스가 자신만의 가상 주소 공간을 갖는 것처럼 보이게 한다. 왜 이런 짓을..? 우리를 위해서다...프로세스 입장에서는 나만의 저장 공간이 충분하므로 "어따 저장하지?" 걱정할 필요 없이 그냥 필요할 때마다 운영체제에게 "메모리 내놔!" 하면 된다. 또한 각 프로세스는 자신의 주소 공간에만 접근할 수 있으므로 하나의 프로세스가 수행하는 각종 메모리 연산은 다른 프로그램의 주소 공간에 영향을 주지 않는다는 보호 효과도 있다.

그런데 실제로는 물리 메모리는 공유 자원이라 둘이 될 수 없지 않나? 이게 왜 되지? 물리 메모리는 하나지만 **운영체제가 각 프로세스의 주소 공간을 공유 자원인 물리 메모리에 매핑**함으로써 각자 쓰는 것처럼 보이게 한다. 

#### 주소공간의 구조
##### 코드
명령어가 저장되는 영역으로 정적이기 때문에 프로그램이 실행되어도 추가 메모리를 필요로 하지 않는다. 

##### 데이터
전역 변수, 정적 변수가 저장되는 영역으로, 프로그램이 처음 실행될 때 할당되며 종료 시 해제된다. 

##### 스택
함수 호출 체인 상 현재 위치, 지역 변수, 함수 인자와 반환 값 등을 저장하며 위쪽으로 확장된다. 할당과 반환이 컴파일러에 의해 암묵적으로 이루어지기 때문에 우리가 신경 쓰지 않아도 된다!

##### 힙
동적으로 할당된 메모리를 위한 영역으로 아래쪽으로 커진다. 모든 할당과 반환을 우리가 명시적으로 처리해야 한다.(하지만 킹짱애플은 ARC를 지원한다구~)